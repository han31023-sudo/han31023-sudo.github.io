<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="description" content="Simple Tap Game â€” tap to increase your score. High score is saved locally." />
  <title>Tap Game</title>

  <!-- AdSense (kept as in original) -->
  <script async
    src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"
    data-ad-client="ca-pub-7565840236819481"></script>

  <style>
    :root {
      --bg: #0f172a;
      --card: #0b1220;
      --accent: #06b6d4;
      --text: #e6eef8;
      --muted: #93a3b8;
    }
    html,body{
      height:100%;
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;
      background: linear-gradient(180deg,#071028 0%, #071a2b 100%);
      color:var(--text);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }
    .wrapper{
      min-height:100%;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:2rem;
      box-sizing:border-box;
    }
    .card{
      width:100%;
      max-width:420px;
      background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01));
      border-radius:12px;
      padding:1.5rem;
      box-shadow: 0 6px 24px rgba(2,6,23,0.6);
      text-align:center;
    }
    h1{margin:0 0 0.5rem 0;font-size:1.5rem;}
    .scores{display:flex;gap:1rem;justify-content:center;margin-bottom:1rem;align-items:baseline;}
    #score {font-size:1.25rem;font-weight:600;}
    #highscore {font-size:0.9rem;color:var(--muted);}
    button#tapBtn{
      appearance:none;
      -webkit-appearance:none;
      border: none;
      background: linear-gradient(180deg,var(--accent), #0ea5a9);
      color:#021827;
      padding:1rem 2rem;
      font-size:1.25rem;
      font-weight:700;
      border-radius:10px;
      cursor:pointer;
      width:100%;
      box-shadow: 0 8px 18px rgba(3,12,20,0.5), inset 0 -4px 8px rgba(255,255,255,0.05);
      transition: transform .08s ease, box-shadow .08s ease;
      user-select:none;
      touch-action:manipulation;
    }
    button#tapBtn:active{transform:translateY(2px) scale(.995); box-shadow: 0 6px 14px rgba(3,12,20,0.45)}
    .controls{display:flex;gap:0.5rem;margin-top:0.75rem;}
    button.secondary{
      background:transparent;
      color:var(--text);
      border:1px solid rgba(255,255,255,0.06);
      padding:0.6rem 0.9rem;
      border-radius:8px;
      cursor:pointer;
      flex:1;
    }
    .ads{margin-top:1rem;}
    footer{margin-top:1rem;color:var(--muted);font-size:0.85rem;}
  </style>
</head>
<body>
  <div class="wrapper">
    <main class="card" role="main">
      <h1>Tap Game</h1>

      <div class="scores" aria-hidden="false">
        <div id="score" aria-live="polite">Score: 0</div>
        <div id="highscore">High: 0</div>
      </div>

      <button id="tapBtn" aria-label="Tap button">TAP</button>

      <div class="controls" role="group" aria-label="game controls">
        <button id="resetBtn" class="secondary" aria-label="Reset score">Reset</button>
        <button id="soundBtn" class="secondary" aria-pressed="false" aria-label="Toggle sound">Sound: Off</button>
      </div>

      <!-- Banner -->
      <div class="ads" aria-hidden="true">
        <ins class="adsbygoogle"
             style="display:block"
             data-ad-client="ca-pub-7565840236819481"
             data-ad-slot="3776142128"
             data-ad-format="auto"></ins>
      </div>

      <footer>
        Tip: Press Space or Enter to tap. High score is stored locally in your browser.
      </footer>
    </main>
  </div>

  <script>
  (adsbygoogle = window.adsbygoogle || []).push({});

  (function(){
    const scoreEl = document.getElementById('score');
    const highEl = document.getElementById('highscore');
    const tapBtn = document.getElementById('tapBtn');
    const resetBtn = document.getElementById('resetBtn');
    const soundBtn = document.getElementById('soundBtn');

    let score = 0;
    const HS_KEY = 'tapgame_highscore_v1';
    let high = parseInt(localStorage.getItem(HS_KEY), 10) || 0;
    let soundEnabled = false;

    function updateDisplays(){
      scoreEl.textContent = 'Score: ' + score;
      highEl.textContent = 'High: ' + high;
      soundBtn.textContent = 'Sound: ' + (soundEnabled ? 'On' : 'Off');
      soundBtn.setAttribute('aria-pressed', String(soundEnabled));
    }

    function saveHighscore(){
      try{
        localStorage.setItem(HS_KEY, String(high));
      }catch(e){
        // ignore storage errors (e.g., private mode)
      }
    }

    function tap(){
      score += 1;
      if (score > high){
        high = score;
        saveHighscore();
      }
      // small visual feedback
      tapBtn.animate([{ transform: 'scale(1)' }, { transform: 'scale(0.98)' }, { transform: 'scale(1)' }], { duration: 120 });
      if (soundEnabled) {
        playClick();
      }
      updateDisplays();
    }

    function reset(){
      if (!confirm('Reset score and high score?')) return;
      score = 0;
      high = 0;
      saveHighscore();
      updateDisplays();
    }

    // Simple click sound using WebAudio
    let audioCtx = null;
    function playClick(){
      try {
        if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        const o = audioCtx.createOscillator();
        const g = audioCtx.createGain();
        o.type = 'sine';
        o.frequency.value = 880;
        g.gain.value = 0.02;
        o.connect(g);
        g.connect(audioCtx.destination);
        o.start();
        o.stop(audioCtx.currentTime + 0.05);
      } catch(e) {
        // ignore audio errors
      }
    }

    // Event listeners
    tapBtn.addEventListener('click', tap);

    // Prevent double activation on touch devices: use touchstart
    tapBtn.addEventListener('touchstart', function(e){
      e.preventDefault(); // prevent the synthesized mouse events
      tap();
    }, {passive:false});

    // Keyboard support (space or enter)
    document.addEventListener('keydown', function(e){
      if (e.code === 'Space' || e.code === 'Enter') {
        // prevent page scroll on Space
        if (e.code === 'Space') e.preventDefault();
        tap();
      }
    });

    resetBtn.addEventListener('click', reset);

    soundBtn.addEventListener('click', function(){
      soundEnabled = !soundEnabled;
      updateDisplays();
    });

    // initialize
    updateDisplays();

    // Accessibility: ensure score is announced on load
    setTimeout(() => {
      scoreEl.setAttribute('aria-live', 'polite');
    }, 500);
  })();
  </script>
</body>
</html>
